1:HL["/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/efb8fa6fa0f88240.css",{"as":"style"}]
0:["pvZnXPp3suTz4_6oxmeNB",[[["",{"children":["blog",{"children":[["slug","LSS12","d"],{"children":["__PAGE__?{\"slug\":\"LSS12\"}",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/efb8fa6fa0f88240.css","precedence":"next"}]],"$L4"]]]]
5:I{"id":6685,"chunks":["685:static/chunks/685-1c7543f9470b706b.js","222:static/chunks/222-846c3dee61afe17f.js","404:static/chunks/app/blog/page-f6630789f282f574.js"],"name":"","async":false}
6:I{"id":3222,"chunks":["685:static/chunks/685-1c7543f9470b706b.js","222:static/chunks/222-846c3dee61afe17f.js","404:static/chunks/app/blog/page-f6630789f282f574.js"],"name":"Image","async":false}
7:I{"id":7767,"chunks":["272:static/chunks/webpack-b095ed2a5c5bf76b.js","971:static/chunks/fd9d1056-5fc0659828b82348.js","596:static/chunks/596-5f69a5936ae99734.js"],"name":"default","async":false}
8:I{"id":7920,"chunks":["272:static/chunks/webpack-b095ed2a5c5bf76b.js","971:static/chunks/fd9d1056-5fc0659828b82348.js","596:static/chunks/596-5f69a5936ae99734.js"],"name":"default","async":false}
3:[null,["$","html",null,{"lang":"kr","children":["$","body",null,{"className":"__className_e66fe9","children":["$","div",null,{"className":"w-full flex flex-col items-center p-3","children":[null,["$","header",null,{"className":"w-full max-w-3xl flex flex-row justify-between items-center my-1","children":[["$","$L5",null,{"href":"/","className":"flex flex-row items-center","children":[["$","$L6",null,{"src":"/logo.png","alt":"로고","width":30,"height":30,"objectFit":"cover","className":"rounded-full"}],["$","span",null,{"className":"mx-2 font-semibold text-lg","children":"jiohh blog"}]]}],["$","nav",null,{"children":[["$","$L5","Home",{"href":"/","className":"mr-5 ","children":"Home"}],["$","$L5","Blog",{"href":"/blog","className":"mr-5 ","children":"Blog"}],["$","$L5","Category",{"href":"/category","className":"mr-5 ","children":"Category"}]]}]]}],["$","main",null,{"className":"w-full max-w-3xl","children":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":"$undefined","childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L7",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children",["slug","LSS12","d"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L8",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$L9",["$","div",null,{"className":"mt-10 prose","children":[["$","h1",null,{"className":"","children":"12장 - 채팅 시스템 설계"}],[["$","h2",null,{"children":"목표"}],"\n",["$","p",null,{"children":"채팅 앱을 만들어보자!"}],"\n",["$","h2",null,{"children":"1단계 문제 이해 및 설계 범위 확정"}],"\n",["$","p",null,{"children":["채팅 앱이라고 했을 때 사람들이 떠올리는 것은 제각각이다.",["$","br",null,{}],"\n","일대일 채팅, 그룹 채팅, 응답지연이 낮아야하는 음성 채팅등 여려 경우가 있다.",["$","br",null,{}],"\n","질문을 통해 원하는 앱이 무엇인지 정확히 알아내야한다."]}],"\n",["$","p",null,{"children":"지원자 질문"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"1:1 채팅 앱인지 그룹 채팅 앱인지"}],"\n",["$","li",null,{"children":"모바일 앱인지 웹 앱인지"}],"\n",["$","li",null,{"children":"처리해야하는 트래픽 규모는?"}],"\n",["$","li",null,{"children":"그룹 채팅의 경우에 인원 제한이 있는지?"}],"\n",["$","li",null,{"children":"중요기능으로 어떤 것이 있는지?"}],"\n",["$","li",null,{"children":"메시지 길이에 제한이 있는지?"}],"\n",["$","li",null,{"children":"종단간 암호화를 지원해야 하는지?"}],"\n",["$","li",null,{"children":"채팅 이력은 얼마나 오래 보관해야 하는지?"}],"\n"]}],"\n",["$","p",null,{"children":"도출 된 정보"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"응답지연이 낮은 일대일 채팅 기능"}],"\n",["$","li",null,{"children":"최대 100명까지 참여할 수 있는 그룹 채팅 기능"}],"\n",["$","li",null,{"children":"사용자의 접속상태 표시 기능"}],"\n",["$","li",null,{"children":"다양한 단말 지원. 하나의 계정으로 여러 단말에 동시 접속 지원"}],"\n",["$","li",null,{"children":"푸시 알림"}],"\n",["$","li",null,{"children":"5천만 DAU를 처리할 수 있도록 할 것"}],"\n"]}],"\n",["$","h2",null,{"children":"2단계 개략적 설게안 제시 및 동의 구하기"}],"\n",["$","p",null,{"children":["클라이언트는 서로 직접 통신하지 않기 때문에 채팅 서비스와 통신을 해야한다.",["$","br",null,{}],"\n","채팅 서비스는 다음 기능을 제공해야 한다."]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"클라이언트들로부터 메시지 수신"}],"\n",["$","li",null,{"children":"메시지 수신자(recipeint) 결정 및 전달"}],"\n",["$","li",null,{"children":"수신자가 접속 상태가 아닌 경우 접속할 때 가지 메시지 보관"}],"\n"]}],"\n",["$","p",null,{"children":"채팅 서비스의 경우 어떤 통신 프로토콜을 사용할 것인가도 중요한 문제이다."}],"\n",["$","p",null,{"children":["HTTP의 경우에는 메시지 전송 요도로 괜찮은 선택이다.",["$","br",null,{}],"\n","(keep-alive헤더를 통해 끊지않고 계속 유지할 수 도 있음)"]}],"\n",["$","p",null,{"children":["하지만 메시지 수신 시나리오는 복잡하다.",["$","br",null,{}],"\n","HTTP는 클라이언트가 연결을 만드는 프로토콜이므로, 서버에서 클라이언트로 임의 시점에 메시지를 보내는 데는 쉽게 쓰일 수 없다."]}],"\n",["$","p",null,{"children":"서버가 연결을 만드는 것처럼 동작할 수 있도록 많은 기법들이 존재하는데 이에 대해 알아보자."}],"\n",["$","h3",null,{"children":"폴링"}],"\n",["$","p",null,{"children":["클라이언트가 주기적으로 서버에게 새 메시지가 있느냐고 물어보븝 방법.",["$","br",null,{}],"\n","폴링을 자주하면 폴링비용이 올라감 + 메시지가 없는 경우 서버 자원 낭비"]}],"\n",["$","h3",null,{"children":"롱 폴링"}],"\n",["$","p",null,{"children":"클라이언트는 새 메시지가 반환되거나 타임아웃 될 때까지 연결을 유지한다.\n클라이언트는 새 메시지를 받으면 기존 연결을 종료하고 서버에 새로운 요청을 보내어 모든 절차를 다시 시작한다."}],"\n",["$","img",null,{"src":"/images/LSS/longPolling.jpg","width":"80%","height":"100%"}],"\n",["$","p",null,{"children":"단점"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"메시지를 보내는 클라이언트와 수신하는 클라이언트가 같은 채팅 서버에 접속하게 되지 않을 수 있음"}],"\n",["$","li",null,{"children":"서버 입장에서는 클라이언트가 연결을 해제했는지 아닌지 알 좋은 방법이 없다"}],"\n",["$","li",null,{"children":"메시지를 많이 받지 않은 클라이언트도 주기적으로 서버에 다시 접속해야함"}],"\n"]}],"\n",["$","h3",null,{"children":"웹 소켓"}],"\n",["$","p",null,{"children":"서버가 클라이언트에게 비동기메시지를 보낼때 가장 널리 사용하는 기술"}],"\n",["$","p",null,{"children":"웹소켓 연결은 클라이언트가 시작하여, 한번 맺어진 연결은 항구적이며 양방향이다.\n한번 만들어지면 클라이언트에게 비동기적으로 메시지를 전송할 수 있다."}],"\n",["$","p",null,{"children":"웹소켓을 이용하면 메시지를 보낼 때나 받을 때 동일한 프로토콜을 사용할 수 있음\n구현도 단순하고 직관적이다."}],"\n",["$","p",null,{"children":"웹 소켓 연결은 항구적으로 유지되어야하기 때문에 연결관리를 효율적으로 해야한다."}],"\n",["$","h3",null,{"children":"개략적인 설계안"}],"\n",["$","p",null,{"children":"클라이언트와 주 서버 통신 프로토콜 : 웹 소켓\n이외 대부분의 기능(회원가입, 로그인, 사용자 프로파일 등) : HTTP"}],"\n",["$","h4",null,{"children":"무상태 서비스"}],"\n",["$","p",null,{"children":"전통적인 요청/응답 서비스로 로그인, 회원가입, 사용자 프로파일 표시 등"}],"\n",["$","img",null,{"src":"/images/LSS/nonstateful.jpg","width":"80%","height":"100%"}],"\n",["$","p",null,{"children":"로드밸런서를 사용하며 모놀리틱, 마이크로서비스 등으로 구현한다."}],"\n",["$","h4",null,{"children":"상태 유지 서비스"}],"\n",["$","p",null,{"children":["각 클라이언트가 채팅 서버와 독립적인 네트워크 연결을 유지해야 한다.",["$","br",null,{}],"\n","클라이언트는 서버가 살아 있는 한 다른 서버로 연결을 변경하지 않는다."]}],"\n",["$","p",null,{"children":"서비스 탐색 서비스, 채팅 서비스와 협력하여 특정 서버에 부하가 몰리지 않도록 하여야 한다."}],"\n",["$","h4",null,{"children":"제3자 서비스 연동"}],"\n",["$","p",null,{"children":["제 3자 서비스 : 푸시 알림",["$","br",null,{}],"\n","새 메시지를 받았다면 설사 앱이 실행 중이지 않더라도 알림을 받아야 해서이다."]}],"\n",["$","h4",null,{"children":"규모 확장성"}],"\n",["$","img",null,{"src":"/images/LSS/chatfullserver.jpg","width":"80%","height":"100%"}],"\n",["$","p",null,{"children":["이론적으로는 모든 사용자 연결을 최신 클라우드 서버 한대로 처리할 수 있기는 여러이유(SPOF등)으로 분할하나 한대를 갖는 설계안으로 출발하여 다듬어 나가는 것도 괜찮다. 다음은 서버를 한 대만 갖는 설계안이다.",["$","br",null,{}],"\n","키-값 저장소에는 채팅 이력을 보관한다."]}],"\n",["$","h4",null,{"children":"저장소"}],"\n",["$","p",null,{"children":"어떤 데이터 베이스를 쓸 것 인가? 데이터의 유형과 읽기/쓰기 연산의 패턴을 중요하게 봐야한다."}],"\n",["$","p",null,{"children":"채팅 시스템이 다루는 데이터"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["사용자 프로파일, 설정, 친구목록",["$","br",null,{}],"\n","안전성을 보장하는 관계형 데이터 베이스에 보관"]}],"\n",["$","li",null,{"children":"채팅 이력\n채팅 데이터는 패턴을 알아보자"}],"\n"]}],"\n",["$","p",null,{"children":"채팅 데이터의 패턴"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"양이 엄청나다."}],"\n",["$","li",null,{"children":"빈번하게 사용되는 것은 주로 최근에 주고받는 메시지다."}],"\n",["$","li",null,{"children":"대체로 최근에 주고받은 메시지 데이터를 참고하나 특정 메시지로 점프하여 무작위적인 데이터 접근을 하게되는 일도 있다."}],"\n",["$","li",null,{"children":"1:1 채팅 앱의 경우 읽기:쓰기 비율은 대략 1:1정도다."}],"\n"]}]]]}],null],"segment":"__PAGE__?{\"slug\":\"LSS12\"}"},"styles":[]}],"segment":["slug","LSS12","d"]},"styles":[]}],"segment":"blog"},"styles":[]}]}],["$","footer",null,{"className":"w-full max-w-3xl items-center ","children":[["$","div",null,{"className":"h-28"}]," "]}]]}]}]}],null]
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Create Next App"}],["$","meta","2",{"name":"description","content":"Generated by create next app"}],["$","meta","3",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","4",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","meta","5",{"name":"next-size-adjust"}]]
9:null
